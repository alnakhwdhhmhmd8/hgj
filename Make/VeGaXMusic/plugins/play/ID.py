import asyncio
import os
import time
import requests
import datetime
import random
import os
import time
from asyncio import sleep
from pyrogram import Client, filters
from pyrogram import enums, filters
from VeGaXMusic import app
from pytz import timezone
import datetime
from pytz import timezone
from pyrogram import enums
import aiohttp
import datetime
from pytz import timezone
from pyrogram import filters
from pyrogram import Client
from typing import Union
from random import choice
from config import OWNER_ID
from config import BANNED_USERS
from config import BANNED_USERS, OWNER_ID
from VeGaXMusic.core.call import KIM
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from pyrogram.types import Message, CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton, InputMediaPhoto
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from VeGaXMusic import (Apple, Resso, SoundCloud, Spotify, Telegram, YouTube, app)
from VeGaXMusic import app
from telegraph import upload_file
from asyncio import gather
from pyrogram.errors import FloodWait
from pyrogram.types import InlineKeyboardButton, InlineKeyboardMarkup

import asyncio
from PIL import Image, ImageDraw, ImageFont
from pyrogram import filters, Client, enums
from pyrogram.types import *
from typing import Union, Optional
from VeGaXMusic import app as Hiroko 

from PIL import (Image, ImageDraw, ImageEnhance, ImageFilter,
                 ImageFont, ImageOps)
import asyncio
import os
import random
import re
import textwrap
import aiofiles
import aiohttp
from PIL import Image, ImageDraw, ImageEnhance, ImageFilter, ImageFont, ImageOps
from youtubesearchpython.__future__ import VideosSearch
import numpy as np

from config import YOUTUBE_IMG_URL


import asyncio
import os
import time
import requests
import datetime
import random
import os
import time
from asyncio import sleep
from pyrogram import Client, filters
from pyrogram import enums, filters
from VeGaXMusic import app
from config import *
import config
from VeGaXMusic import  app
from config import OWNER_ID
from pytz import timezone
from pyrogram import enums
import aiohttp

import datetime
from pytz import timezone
from pyrogram import filters
from pyrogram import Client
from typing import Union
from random import choice
from config import OWNER_ID
from config import BANNED_USERS
from config import BANNED_USERS, OWNER_ID
from VeGaXMusic.core.call import KIM
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from pyrogram.types import Message, CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton, InputMediaPhoto
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from VeGaXMusic import (Apple, Resso, SoundCloud, Spotify, Telegram, YouTube, app)
from VeGaXMusic import app
from telegraph import upload_file
from asyncio import gather
from pyrogram.errors import FloodWait
from pyrogram.types import InlineKeyboardButton, InlineKeyboardMarkup



from datetime import datetime
from pyrogram import Client, filters
from pyrogram.types import Message, InlineKeyboardButton, InlineKeyboardMarkup


import asyncio
from PIL import Image, ImageDraw, ImageFont
from pyrogram import filters, Client, enums
from pyrogram.types import *
from typing import Union, Optional
from VeGaXMusic import app as Hiroko 

# Function to get font and resize text



import requests
from PIL import Image
import os






import asyncio
import os
import random
import re
import textwrap
import aiofiles
import aiohttp
from PIL import Image, ImageDraw, ImageEnhance, ImageFilter, ImageFont, ImageOps
from youtubesearchpython.__future__ import VideosSearch
import numpy as np

from config import YOUTUBE_IMG_URL


import asyncio
import os
import time
import requests
import datetime
import random
import os
import time
from asyncio import sleep
from pyrogram import Client, filters
from pyrogram import enums, filters
from VeGaXMusic import app

from pytz import timezone
from pyrogram import enums
import aiohttp
import datetime
from pytz import timezone
from pyrogram import filters
from pyrogram import Client
from typing import Union
from random import choice
from config import OWNER_ID
from config import BANNED_USERS
from config import BANNED_USERS, OWNER_ID
from VeGaXMusic.core.call import KIM
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from pyrogram.types import Message, CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton, InputMediaPhoto
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from VeGaXMusic import (Apple, Resso, SoundCloud, Spotify, Telegram, YouTube, app)
from VeGaXMusic import app
from telegraph import upload_file
from asyncio import gather
from pyrogram.errors import FloodWait
from pyrogram.types import InlineKeyboardButton, InlineKeyboardMarkup










# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂[𝗩.𝗘.𝗚.𝗔]▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
#──██████──────██████───█████████████──────██████████████───████████████████────
#──██──██──────██──██───██─────────██────██────────────██───██────────────██────
#──██──██──────██──██───██──█████████───██───████████████───██───███████──██────
#──██──██──────██──██───██──██──────────██──██──────────────██───██───██──██────
#──██──██──────██──██───██──██──────────██──██──────────────██───██───██──██────
#──██──██──────██──██───██──██──────────██──██──────────────██───██───██──██────
#──██──██──────██──██── ██──██──────────██──██──────────────██───██───██──██───
#──██──██──────██──██───██──█████████───██──██───███████────██───███████──██────
#──██───██────██───██───██─────────██───██──██───██────██───██────────────██────
#───██───██──██───██────██──█████████───██──██───████──██───██───███████──██────
#────██───████───██─────██──██──────────██──██─────██──██───██───██───██──██────
#─────██───██───██──────██──██──────────██───██────██──██───██───██───██──██────
#──────██──────██───────██──██───────────██───██───██──██───██───██───██──██────
#───────██────██────────██──█████████─────██──███████──██───██───██───██──██────
#────────██──██─────────██─────────██──────██─────────██────██───██───██──██────
#─────────████──────────█████████████───────████████████────███████───██████────
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂[𝗩.𝗘.𝗚.𝗔]▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ̷𝖾𝙙𝙚𝙥𝙡𝙤𝙮𝙚𝙙 𝙨𝙪𝙘𝙘𝙚𝙨𝙨𝙛𝙪𝙡𝙡𝙮
# (2024-2025) 𝙗𝙮: @𝙏𝙊𝙋𝙑𝙀𝙂𝘼
# 𝙂𝙧𝙚𝙚𝙩𝙞𝙣𝙜𝙨 𝙛𝙧𝙤𝙢 : 𝙑𝙚𝙂𝙖

   





import asyncio
from PIL import Image, ImageDraw, ImageFont
from pyrogram import filters, Client, enums
from pyrogram.types import *
from typing import Union, Optional
from VeGaXMusic import app as Hiroko 

# Function to get font and resize text



import requests
from PIL import Image
import os

import asyncio
import re
import time
import requests
import aiohttp
import time
import asyncio
from pyrogram import Client, filters
from pyrogram import filters
from datetime import datetime
from pyrogram import enums
from VeGaXMusic.misc import SUDOERS
from config import OWNER_ID
from config import BANNED_USERS
from config import BANNED_USERS, OWNER_ID
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from pyrogram.types import CallbackQuery, InputMediaPhoto, InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.enums import ChatMemberStatus, ParseMode
from VeGaXMusic import app
from pyrogram.enums import ChatMembersFilter
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import ChatPermissions, ChatPrivileges
from config import *
from pyrogram.enums import ChatMembersFilter
from telegraph import upload_file
from asyncio import gather
from pyrogram.enums import ChatMembersFilter
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import ChatPermissions, ChatPrivileges
from config import *
from pyrogram.enums import ChatMembersFilter
import asyncio

from pyrogram.enums import ParseMode

from VeGaXMusic import app
from VeGaXMusic.utils.database import is_on_off
from config import LOG_GROUP_ID


from pyrogram import filters
from pyrogram import Client
from VeGaXMusic.core.call import KIM
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from VeGaXMusic import (Apple, Resso, SoundCloud, Spotify, Telegram, YouTube, app)
from VeGaXMusic import app
from telegraph import upload_file
from asyncio import gather

import random
from VeGaXMusic.misc import SUDOERS
from pyrogram.types import (Message,InlineKeyboardButton,InlineKeyboardMarkup,CallbackQuery,ChatPrivileges)
from pyrogram import filters, Client
from VeGaXMusic import app
from config import *



def is_owner(_, __, message):

    return message.from_user.id == OWNER_ID

# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


iddof = []


@app.on_message(filters.command(["قفل الايدي", "تعطيل الايدي"], ""), group=509)
async def iddlock(client, message):
   get = await client.get_chat_member(message.chat.id, message.from_user.id)
   if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165:
      if message.chat.id in iddof:
        return await message.reply_text(" الايدي معطل من قبل")
      iddof.append(message.chat.id)
      return await message.reply_text(" تم تعطيل الايدي بنجاح")
   else:
      return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")

@app.on_message(filters.command(["فتح الايدي", "تفعيل الايدي"], ""), group=678)
async def iddopen(client, message):
   get = await client.get_chat_member(message.chat.id, message.from_user.id)
   if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165:
      if not message.chat.id in iddof:
        return await message.reply_text("الايدي مفعل من قبل ")
      iddof.remove(message.chat.id)
      return await message.reply_text("تم تفعيل الايدي بنجاح")
   else:
      return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")



id = {}

@app.on_message(filters.command(["ايدي","الايدي","ا","id","/id","/ID","ID"], ""), group=99)
async def muid(client: Client, message):
    if message.chat.id in iddof:
        return await message.reply_text("الايدي معطل من قبل الادمن")
    try:
        user = await client.get_chat(message.from_user.id)
        user_id = user.id
        username = user.username  # Raw username (might be None)
        display_username = username or "غير متوفر" #  For display purposes
        first_name = user.first_name or "غير متوفر"
        bioo = user.bio or "غير متوفر"
        
        photo = user.photo.big_file_id if user.photo else None
        
        if user.id not in id:
            id[user.id] = []
        idd = len(id[user.id])
        
        # Build inline keyboard buttons conditionally
        buttons = []
        if username:  # Only add URL button if username exists
            buttons.append(
                [InlineKeyboardButton(first_name, url=f"https://t.me/{username}")]
            )
        buttons.append(
            [InlineKeyboardButton(f"{idd} ❤️", callback_data=f"heart{user_id}")]
        )
        
        # Caption uses display_username (includes fallback text)
        caption = (
            f"<b><blockquote>╭◉ᚐɴᴧᴍᴇ : {message.from_user.mention}\n"
            f"╰◉ᚐᴜsᴇꝛ : @{display_username}\n"
            f"╭◉ᚐɪᴅ : <code>{user_id}</code>\n"
            f"╰◉ᚐʙɪᴏ : {bioo}\n"
            f"╭◉ᚐᴄʜᴧᴛ : {message.chat.title}\n"
            f"╰◉ᚐᴄʜᴧᴛ ɪᴅ : <code>{message.chat.id}</code></b></blockquote>"
        )
        
        if photo:
            photo = await client.download_media(photo)
            await message.reply_photo(
                photo=photo,
                caption=caption,
                reply_markup=InlineKeyboardMarkup(buttons)
            )
        else:
            await message.reply_text(
                caption,
                reply_markup=InlineKeyboardMarkup(buttons))
    except Exception as e:
        print(f"An error occurred: {e}")


@app.on_callback_query(filters.regex("heart"), group=54787866)
async def heart(client, query: CallbackQuery):  
    callback_data = query.data.strip()  
    callback_request = callback_data.replace("heart", "")  
    username = int(callback_request)
    try:
        usr = await client.get_chat(username)
        heart_giver = query.from_user.mention or query.from_user.first_name
        if usr.id not in id:
            id[usr.id] = []
        if heart_giver not in id[usr.id]:
            id[usr.id].append(heart_giver)
            fan_count = len(id[usr.id])
            await client.send_message(usr.id, f"قام {heart_giver} بوضع قلب لك واصبح عدد الفانزات {fan_count}")
        else:
            id[usr.id].remove(heart_giver)
            fan_count = len(id[usr.id])
            await client.send_message(usr.id, f"قام {heart_giver} بالغاء قلب لك واصبح عدد الفانزات {fan_count}")
        
        idd = len(id[usr.id])
        await query.edit_message_text(
            f"<blockquote><b>╭◉ᚐɴᴧᴍᴇ : {usr.first_name}\n╰◉ᚐᴜsᴇꝛ : @{usr.username}\n╭◉ᚐɪᴅ : <code>{usr.id}</code>\n╰◉ᚐʙɪᴏ : {usr.bio}\n╭◉ᚐᴄʜᴧᴛ : {query.message.chat.title}\n╰◉ᚐᴄʜᴧᴛ ɪᴅ : <code>{query.message.chat.id}</code></b></blockquote>", 
            reply_markup=InlineKeyboardMarkup([[InlineKeyboardButton(usr.first_name, url=f"https://t.me/{usr.username}")], [InlineKeyboardButton(f"{idd} ❤️", callback_data=f"heart{usr.id}")]])
        )
    except Exception as e:
        print(f"An error occurred: {e}")
        

# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂[𝗩.𝗘.𝗚.𝗔]▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂

@app.on_message(filters.command(["فنزاتي", "المعجابين"], ""), group=5847878)
async def get_mt_fans(client: Client, message):
    user_id = message.from_user.id
    fan_count = len(id.get(user_id, []))  # 
    fann_count = "79911"
    
    if user_id == 7728230165:
        return await message.reply_text(f"عدد القلوب لديك: {fann_count} ❤️")
    
    if fan_count == 0:
        await message.reply_text("ليس هناك معجابين")
    else:
        await message.reply_text(f"<blockquote>عدد القلوب لديك: {fan_count} ❤️</blockquote>")

# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂[𝗩.𝗘.𝗚.𝗔]▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


@app.on_message(filters.command(["فنزاته", "المعجابين"], ""), group=5847878)
async def get_mt_fans(client: Client, message):
    user_id = message.reply_to_message.from_user.id
    fan_count = len(id.get(user_id, []))  # 
    fann_count = "79911"
    
    if user_id == 7728230165:
        return await message.reply_text(f"عدد القلوب لديك: {fann_count} ❤️")
    
    if fan_count == 0:
        await message.reply_text("ليس هناك معجابين")
    else:
        await message.reply_text(f"<blockquote>عدد القلوب لديك: {fan_count} ❤️</blockquote>")

# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂[𝗩.𝗘.𝗚.𝗔]▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


@app.on_message(filters.command(["الجروب","جروب","انا فين","كروب","مجموعه","المجموعة","/group"], ""), group=666)
async def ginnj(client: Client, message: Message):
    chat_idd = message.chat.id
    chat_name = message.chat.title
    chat_username = f"@{message.chat.username}"
    if message.chat.photo:
        photo = await client.download_media(message.chat.photo.big_file_id)
        await message.reply_photo(photo=photo, caption=f"""<b><b><blockquote> ˚‧SHEIKH˳+\n\n╮◉  اسم الجروب » {chat_name}\n│᚜◉ ايدي الجروب »<code>{chat_idd}</code>\n╯◉  رابط الجروب » {chat_username}</b></blockquote>""",     
    reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        chat_name, url=f"https://t.me/{message.chat.username}")
                ],
            ]
        ),
    )
    else:
        await message.reply_text(f"""<blockquote><b><b> ˚‧SHEIKH˳+\n\n╮◉ اسم الجروب » {chat_name}\n│᚜◉ ايدي الجروب »  -<code>{chat_idd}</code>\n╯◉ رابط الجروب » {chat_username}</b></blockquote>""", reply_markup=InlineKeyboardMarkup([[InlineKeyboardButton(chat_name, url=f"https://t.me/{message.chat.username}")],]))    
        

# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


@app.on_message(filters.command(["فحص الجروب"], ""), group=26777)
async def instatus(Client, message):
    start_time = time.perf_counter()
    user = await app.get_chat_member(message.chat.id, message.from_user.id)
    count = await app.get_chat_members_count(message.chat.id)
    get = await app.get_chat_member(message.chat.id, message.from_user.id)
    if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165:
        chat_idd = message.chat.id
        chat_name = message.chat.title
        chat_username = f"@{message.chat.username}"
        deleted_acc = 0
        premium_acc = 0
        banned = 0
        bot = 0
        uncached = 0
        async for ban in app.get_chat_members(message.chat.id, filter=enums.ChatMembersFilter.BANNED):
            banned += 1
        async for member in app.get_chat_members(message.chat.id):
            user = member.user
            if user.is_deleted:
                deleted_acc += 1
            elif user.is_bot:
                bot += 1
            elif user.is_premium:
                premium_acc += 1
            else:
                uncached += 1
        end_time = time.perf_counter()
        timelog = "{:.2f}".format(end_time - start_time)
        if message.chat.photo:
             photo = await app.download_media(message.chat.photo.big_file_id)
             
             await message.reply_photo(photo=photo,  caption=f"""<blockquote><b>»⭓ɢꝛᴏᴜᴘ ✘ ɪɴꜰᴏꝛᴍᴧᴛɪᴏɴ♪</blockquote>

<blockquote>╮◉   الاسم : {message.chat.title} 
│᚜◉  يوزر : @{message.chat.username}
╯◉   الأعضاء :  {count} 

╮◉   البوتات : {bot}
│᚜◉  الحسابات المحذوفه : {deleted_acc}
│᚜◉  الحسابات المحظوره : {banned}
╯◉   الحسابات الموثقة : {premium_acc}</b></blockquote>""",
         reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        chat_name, url=f"https://t.me/{message.chat.username}")
                ],
            ]
        ),
    )
        else:
             await message.reply_text(f"""<blockquote><b>»⭓ɢꝛᴏᴜᴘ ✘ ɪɴꜰᴏꝛᴍᴧᴛɪᴏɴ♪</blockquote>\n╮◉  الاسم : {message.chat.title}\n│᚜◉ يوزر : @{message.chat.username}\n╯◉  الأعضاء :  {count} \n╮◉  البوتات: {bot}\n│᚜◉  الحساب المحذوفه : {deleted_acc}\n│᚜◉  المحظورين: {banned}\n╯◉  المستخدمون البريميوم: {premium_acc}</b>""", reply_markup=InlineKeyboardMarkup([[InlineKeyboardButton(chat_name, url=f"https://t.me/{message.chat.username}")],]))    
    else:
        sent_message = await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")
        await sleep(3)
        await sent_message.delete()






# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂



mgssof = []
@app.on_message(filters.command(["قفل صورتي", "تعطيل صورتي"], ""), group=277288870000127181882)
async def mgsslock(client, message):
   get = await client.get_chat_member(message.chat.id, message.from_user.id)
   if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165:
      if message.chat.id in mgssof:
        return await message.reply_text("صورتي معطل من قبل")
      mgssof.append(message.chat.id)
      return await message.reply_text("تم تعطيل صورتي بنجاح")
   else:
      return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")

@app.on_message(filters.command(["فتح صورتي", "تفعيل صورتي"], ""), group=726262766000288)
async def mgssopen(client, message):
   get = await client.get_chat_member(message.chat.id, message.from_user.id)
   if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165:
      if not message.chat.id in mgssof:
        return await message.reply_text("صورتي مفعل من قبل\n")
      mgssof.remove(message.chat.id)
      return await message.reply_text("تم تفعيل صورتي بنجاح")
   else:
      return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")
      

RAEAK = ["فاجره","حلوه","فخامه","جميله","خوش","جميله","يععععع","وحشه","مش حلوه","حلوه ياعم","خليك بيها","حبتها","غيرها يعم"]




@app.on_message(filters.command(["صورتي"], ""), group=104)
async def mgssggg(client: Client, message: Message):
    if message.chat.id in mgssof:
      return await message.reply_text("صورتي معطل من قبل الادمن")
      
    usr = await client.get_users(message.from_user.id)
    name = usr.first_name
    chat_id = message.chat.id
    user_id = message.from_user.id
    name = usr.first_name
    if usr.photo:
        photo = await app.download_media(usr.photo.big_file_id)

        await message.reply_photo(photo=photo,      caption=f"""<b> ˚‧SHEIKH˳+\n╮◉ انا كا بوت هقول\n│᚜◉ رأيي يا : {message.from_user.mention}\n╯◉ في صورتك:- ( {choice(RAEAK)} )</b>""", 
        reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        name, url=f"https://t.me/{message.from_user.username}")
                ],
            ]
        ),
    )
    else:
        await message.reply_text("هييه معندك صوره ياروع!")        



@app.on_message(filters.command(["صورته"], ""), group=10476)
async def mgssgg6tg(client: Client, message: Message):
    if message.chat.id in mgssof:
      return await message.reply_text("صورتي معطل من قبل الادمن")
      
    usr = await client.get_users(message.reply_to_message.from_user.id)
    name = usr.first_name
    chat_id = message.chat.id
    user_id = message.from_user.id
    name = usr.first_name
    if usr.photo:
        photo = await app.download_media(usr.photo.big_file_id)

        await message.reply_photo(photo=photo,      caption=f"""<b> ˚‧SHEIKH˳+\n╮◉ انا كا بوت هقول\n│᚜◉ رأيي يا : {message.from_user.mention}\n╯◉ في صورته:- ( {choice(RAEAK)} )</b>""", 
        reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        name, url=f"https://t.me/{message.from_user.username}")
                ],
            ]
        ),
    )
    else:
        await message.reply_text("هييه معندك صوره ياروع!")        
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


@app.on_message(filters.command(["المالك", "صاحب الخرابه", "المنشي"], ""), group=95)
async def ownner(client: Client, message: Message):
    x = []
   
    async for m in app.get_chat_members(message.chat.id, filter=enums.ChatMembersFilter.ADMINISTRATORS):
         if m.status == ChatMemberStatus.OWNER:
            x.append(m.user.id)
    if len(x) != 0:        
       m = await app.get_users(int(x[0]))
       if m.photo:
         async for photo in app.get_chat_photos(x[0],limit=1):
          await message.reply_photo(photo.file_id,caption=f"<blockquote><b>╭◉ᚐɴᴧᴍᴇ : {m.first_name}\n│᚜◉ᴜsᴇꝛ : @{m.username}\n╰◉ᚐɪᴅ : <code>{m.id}</code>\n╭◉ᚐᴄʜᴧᴛ : {message.chat.title}\n╰◉ᚐɪᴅ.ᴄʜᴧᴛ : <code>{message.chat.id}</code></b></blockquote>",reply_markup=InlineKeyboardMarkup(
             [              
               [          
                 InlineKeyboardButton(m.first_name, url=f"https://t.me/{m.username}")
               ],             
             ]                 
            )                     
          )
       else:
        await message.reply_text(f"b><blockquote>╭◉ᚐɴᴧᴍᴇ : {m.first_name}\n│᚜◉ᴜsᴇꝛ : @{m.username}\n╰◉ᚐɪᴅ : <code>{m.id}</code>\n╭◉ᚐᴄʜᴧᴛ : {message.chat.title}\n╰◉ᚐɪᴅ.ᴄʜᴧᴛ : <code>{message.chat.id}</code></b></blockquote>", reply_markup=InlineKeyboardMarkup([[InlineKeyboardButton(m.first_name, url=f"https://t.me/{m.username}")],]))
    else:
        await message.reply_text("عزيزي المالك هذا حساب محذوف")



# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂



kashf = []
@app.on_message(filters.command(["قفل كشف", "تعطيل كشف"], ""), group=8888811223330099)
async def iddlock(client, message):
   get = await client.get_chat_member(message.chat.id, message.from_user.id)
   if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165:
      if message.chat.id in kashf:
        return await message.reply_text("الكشف معطل من قبل")
      kashf.append(message.chat.id)
      return await message.reply_text("تم تعطيل الكشف بنجاح")
   else:
      return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")

@app.on_message(filters.command(["فتح كشف", "تفعيل كشف"], ""), group=70000000000000001111)
async def iddopen(client, message):
   get = await client.get_chat_member(message.chat.id, message.from_user.id)
   if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR]:
      if not message.chat.id in kashf:
        return await message.reply_text("الكشف مفعل من قبل")
      kashf.remove(message.chat.id)
      return await message.reply_text("تم تفعيل الكشف بنجاح")
   else:
      return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")
   
from random import choice
from pyrogram import filters

# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂

                          
message_counts = {}


def update_message_count(group_id, user_id):
    key = (group_id, user_id)
    if key not in message_counts:
        message_counts[key] = 0
    message_counts[key] += 1


async def get_users(client, user_id):
    pass


@app.on_message(filters.group, group=555007655)
async def handle_message(client, message):
    group_id = message.chat.id
    user_id = message.from_user.id
    update_message_count(group_id, user_id)


user_messages = {}
@app.on_message(filters.regex("^رسايلي$") & filters.group, group=62839499)
async def delrdood(app, message):
    chat_id = str(message.chat.id)
    user_id = str(message.from_user.id)
    messages = user_messages.get(chat_id, {}).get(user_id, [])
    await message.reply(f"<blockquote>» عدد رسائلك : {len(messages)}</blockquote>")

@app.on_message(filters.text & filters.group, group=15363729)
async def gettt_rd(app, message):
    chat_id = str(message.chat.id)
    user_id = str(message.from_user.id)
    if chat_id not in user_messages:
        user_messages[chat_id] = {}
    if user_id not in user_messages[chat_id]:
        user_messages[chat_id][user_id] = []
    user_messages[chat_id][user_id].append(message.text)    



@app.on_message(filters.regex("^رسايله$") & filters.group, group=6283949968)
async def delrdoyt(app, message):
    chat_id = str(message.chat.id)
    user_id = str(message.reply_to_message.from_user.id)
    messages = user_messages.get(chat_id, {}).get(user_id, [])
    await message.reply(f"» <blockquote>عدد رسائله : {len(messages)}</blockquote>")


# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


async def get_user_status(user_id: int, message):
    user_id = message.reply_to_message.from_user.id
    chat_id = message.chat.id
    member = await app.get_chat_member(chat_id, user_id)
    rank = "عضو حقير"
    
    if user_id == 7728230165:
        rank = "مطور جاك"
    elif user_id == 7728230165:
        rank = "جاك"
    elif user_id == OWNER_ID:
        rank = "مطور البوت"
    elif member.status == ChatMemberStatus.OWNER:
        rank = "مالك الاساسي"
    elif member.status == ChatMemberStatus.ADMINISTRATOR:
        rank = "مشرف"
    
    return rank


@app.on_message(filters.command(["كشف", "مين دا", "الكشف"], ""), group=1024)
async def reveal_user_info(client, message):
   
    if message.chat.id in kashf:
        return await message.reply_text("The reveal feature is disabled by the admin")

    if not message.reply_to_message:
        return

    try:
        target_user = message.reply_to_message.from_user
        user_id = target_user.id
        chat = message.chat
        username = f"@{target_user.username}" if target_user.username else "لا يوجد يوزر"
        profile_link = f"https://t.me/{target_user.username}" if target_user.username else f"tg://user?id={user_id}"
        
        user_info = await client.get_chat(user_id)
        bio = user_info.bio if user_info.bio else "No bio available"
        
        rank = await get_user_status(user_id, message)
        fan_count = len(id.get(user_id, [])) if 'id' in globals() else 0
        messages = user_messages.get(str(chat.id), {}).get(str(user_id), []) if 'user_messages' in globals() else []

        random_phrases = ["تعبان", "عنده برد", "سخن", "هبوط", "بيتكوهن", "بيتعلق", "بيتمحن", "بيستهبل", "عيان", "في النازل"]
        random_phrase = choice(random_phrases)
        button = InlineKeyboardMarkup([[
            InlineKeyboardButton(
                text=target_user.first_name,
                url=profile_link
            )
        ]])

        caption = (
            f"<b><blockquote>╭◉ᚐɴᴧᴍᴇ : {target_user.mention()}</b>\n"
            f"│᚜◉ᴜsᴇꝛ : {username}\n"
            f"╰◉ᚐɪᴅ : <code>{user_id}</code>\n"
            f"╭◉ᚐʜᴇᴀʟᴛʜ : {random_phrase}\n"
            f"│᚜◉ʟɪᴋᴇꜱ : {fan_count}\n"
            f"│᚜◉ꜱᴛᴀᴛᴜꜱ : {rank}\n"
            f"│᚜◉ᴍᴇꜱꜱᴀɢᴇꜱ : {len(messages)}\n"
            f"╰◉ᚐʙɪᴏ : {bio}\n"
            f"╭◉ᚐᴄʜᴧᴛ : {chat.title}\n"
            f"│᚜◉ᴜsᴇꝛ : @{chat.username if chat.username else 'لا يوجد'}\n"
            f"╰◉ᚐᴄʜᴧᴛ ɪᴅ : <code>{chat.id}</code></blockquote></b>"
        )

        if user_info.photo:
            photo = user_info.photo.big_file_id
            photo_path = await app.download_media(photo)
            await message.reply_photo(
                photo=photo_path,
                caption=caption,
                reply_markup=button
            )
        else:
            await message.reply_text(
                caption,
                reply_markup=button
            )

    except Exception as e:
        print(f"Error: {e}")
        await message.reply_text("❌ حدث خطأ أثناء جلب المعلومات")
        
        
        
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


iddof = []
@app.on_message(filters.command(["قفل جمالي", "تعطيل جمالي"], ""), group=509)
async def iddlock(client, message):
   get = await client.get_chat_member(message.chat.id, message.from_user.id)
   if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165:
      if message.chat.id in iddof:
        return await message.reply_text(" جمالي معطل من قبل")
      iddof.append(message.chat.id)
      return await message.reply_text(" تم تعطيل جمالي بنجاح")
   else:
      return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")

@app.on_message(filters.command(["فتح جمالي", "تفعيل جمالي"], ""), group=678)
async def iddopen(client, message):
   get = await client.get_chat_member(message.chat.id, message.from_user.id)
   if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165:
      if not message.chat.id in iddof:
        return await message.reply_text("جمالي مفعل من قبل ")
      iddof.remove(message.chat.id)
      return await message.reply_text("تم تفعيل  جمالي بنجاح")
   else:
      return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")


@app.on_message(filters.command(["جمالي"], ""), group=104)
async def idjjdd(client, message):
    if message.chat.id in iddof:
      return await message.reply_text(" جمالي معطل من قبل الادمن")
    usr = await client.get_chat(message.from_user.id)
    name = usr.first_name
    i = ["1","10", "15","20", "25","30","35", "40","45", "50","55", "60"," 66", "70","77", "80","85", "90","99", "100","1000" ]
    ik = random.choice(i)
    if usr.photo:
        photo = await app.download_media(usr.photo.big_file_id)
        await message.reply_photo(photo,       caption=f"<b> ˚‧SHEIKH˳+\n╮◉ هل خلق الجمال لتختصره عيناك اما\n│᚜◉ عيناك خلقت لتقنعني ان لا جمال بعدها\n╯◉ جمال عيناك ({ik}) % ❤️</b>", 
    reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        name, url=f"https://t.me/{message.from_user.username}")
                ],
            ]
        ),
    )    
    else:
        await message.reply_text("هييه معندك صوره ياروع!!")               



@app.on_message(filters.command(["جماله"], ""), group=106454)
async def idjjddhhff(client, message):
    if message.chat.id in iddof:
      return await message.reply_text(" جمالي معطل من قبل الادمن")
    usr = await client.get_chat(message.reply_to_message.from_user.id)
    name = usr.first_name
    i = ["1","10", "15","20", "25","30","35", "40","45", "50","55", "60"," 66", "70","77", "80","85", "90","99", "100","1000" ]
    ik = random.choice(i)
    if usr.photo:
        photo = await app.download_media(usr.photo.big_file_id)
        await message.reply_photo(photo,       caption=f"<b> ˚‧SHEIKH˳+\n╮◉ هل خلق الجمال لتختصره عيناك اما\n│᚜◉ عيناك خلقت لتقنعني ان لا جمال بعدها\n╯◉ جمال الارنب ({ik}) % ❤️</b>", 
    reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        name, url=f"https://t.me/{message.from_user.username}")
                ],
            ]
        ),
    )    
    else:
        await message.reply_text("هييه معندك صوره ياروع!!")          

# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


tarof = []

@app.on_message(filters.command(["تعطيل الترحيب","قفل الترحيب"], ""), group=888888888888888811234)
async def disable_welcome(client, message):
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165 or message.from_user.id == 7728230165:
        if message.chat.id in tarof:
            return await message.reply_text("الترحيب معطل من قبل")
        tarof.append(message.chat.id)
        return await message.reply_text("تم تعطيل الترحيب بنجاح")
    else:
        return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بسر")

@app.on_message(filters.command(["تفعيل الترحيب","فتح الترحيب"], ""), group=6666666666123090000011)
async def enable_welcome(client, message):
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID or message.from_user.id == 7728230165 or message.from_user.id == 7728230165:
        if message.chat.id not in tarof:
            return await message.reply_text("الترحيب مفعل من قبل")
        tarof.remove(message.chat.id)
        return await message.reply_text("تم تفعيل الترحيب بنجاح")
    else:
        return await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس")





@app.on_message(filters.new_chat_members, group=554)
async def welcometo_members(client, message):
    if message.chat.id in tarof:
        return await message.reply_text("الترحيب معطل من قبل الادمن")
    
    current_date = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    for user in message.new_chat_members:
        try:
            if user.is_bot:
                continue
                
            chat_id = message.chat.id
            username = user.username if user.username else "لا يوجد معرف"
            mention = user.mention
            
            keyboard = []
            if user.username:
                keyboard = [
                    [InlineKeyboardButton(
                        user.first_name, url=f"https://t.me/{user.username}")
                    ]
                ]
            
            welcome_text = (
                f"<blockquote>لا تُسِئ اللفظ وإن ضَاق عليك الرَّد\n"
                f"ɴᴧᴍᴇ ⌯ {mention}\n"
                f"ᴜѕᴇꝛɴᴧᴍᴇ ⌯ @{username}\n"
                f"ᴅᴀᴛᴇ ⌯ {current_date}</blockquote>"
            )
            
            await app.send_message(
                chat_id=chat_id,
                text=welcome_text,
                reply_markup=InlineKeyboardMarkup(keyboard) if keyboard else None
            )
            
        except Exception as e:
            print(f"حدث خطأ أثناء الترحيب: {str(e)}")

@app.on_message(filters.left_chat_member, group=222307)
async def onn_left_chat_member(_, message: Message):
    try:
        if message.chat.id in tarof:
            return
            
        current_date = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        user = message.left_chat_member
        
        if user.is_bot:
            return
            
        username = user.username if user.username else "لا يوجد معرف"
        mention = user.mention
        
        chat_id = message.chat.id
        leave_text = (
            f"<blockquote>وَأَن لَّيْسَ لِلْإِنسَانِ إِلَّا مَا سَعَىٰ\n"
            f"ɴᴧᴍᴇ ⌯ {mention}\n"
            f"ᴜѕᴇꝛɴᴧᴍᴇ ⌯ @{username}\n"
            f"ᴅᴀᴛᴇ ⌯ {current_date}</blockquote>"
        )
        
        await app.send_message(chat_id=chat_id, text=leave_text)
        
    except Exception as e:
        print(f"حدث خطأ أثناء مغادرة العضو: {str(e)}")

# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂


@app.on_message(filters.command(["اسمي"], ""), group=6658)
async def vgdg(client: Client, message: Message):
    usr = await client.get_chat(message.from_user.id)
    name = usr.first_name
    await message.reply_text(
        f"""<blockquote><b> عااشت الاسامي<b> »» <code>{message.from_user.mention}</code></blockquote>""",
    reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        message.from_user.first_name, url=f"https://t.me/{message.from_user.username}")
                ],
            ]
        )
    )


@app.on_message(filters.command(["اسمه","اسمك"], ""), group=667558)
async def names4(client: Client, message: Message):
    usr = await client.get_chat(message.reply_to_message.from_user.id)
    name = usr.first_name
    await message.reply_text(
        f"""<blockquote><b> اسم الارنب<b> »» <code>{message.from_user.mention}</code></blockquote>""",
    reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        message.from_user.first_name, url=f"https://t.me/{message.from_user.username}")
                ],
            ]
        )
    )


